///|
/// æµ‹è¯•emojiä¸­çš„ç‰¹æ®Šå­—ç¬¦ï¼Œç‰¹åˆ«æ˜¯å˜ä½“é€‰æ‹©ç¬¦
///
/// å˜ä½“é€‰æ‹©ç¬¦-16 (U+FE0F) ç”¨äºå¼ºåˆ¶å°†å‰ä¸€ä¸ªå­—ç¬¦æ˜¾ç¤ºä¸ºemojiæ ·å¼
/// å˜ä½“é€‰æ‹©ç¬¦-15 (U+FE0E) ç”¨äºå¼ºåˆ¶å°†å‰ä¸€ä¸ªå­—ç¬¦æ˜¾ç¤ºä¸ºæ–‡æœ¬æ ·å¼
///
test "emoji variation selectors" {
  // å˜ä½“é€‰æ‹©ç¬¦-16 (U+FE0F) - å¼ºåˆ¶emojiæ ·å¼
  let variation_selector_16 : Char = '\u{fe0f}'
  let variation_selector_15 : Char = '\u{fe0e}'

  // éªŒè¯å­—ç¬¦å€¼ï¼ˆå°†å­—ç¬¦è½¬æ¢ä¸ºå­—ç¬¦ä¸²è¿›è¡Œinspectï¼‰
  inspect(variation_selector_16.to_string(), content="\u{fe0f}")
  println("c\u{fe0f}c")
  inspect(variation_selector_15.to_string(), content="\u{fe0e}")

  // éªŒè¯å­—ç¬¦æ¯”è¾ƒ
  assert_eq(variation_selector_16 == '\u{fe0f}', true)
  assert_eq(variation_selector_15 == '\u{fe0e}', true)
  assert_eq(variation_selector_16 == variation_selector_15, false)
}

///|
/// æµ‹è¯•åŒ…å«å˜ä½“é€‰æ‹©ç¬¦çš„emojiç»„åˆ
/// ä¾‹å¦‚ï¼šæ•°å­— + å˜ä½“é€‰æ‹©ç¬¦ = emojiæ•°å­—
///
test "emoji with variation selectors" {
  // æ•°å­—1 + å˜ä½“é€‰æ‹©ç¬¦-16 = emojiæ•°å­—1
  let emoji_one : String = "1\u{fe0f}"
  let emoji_one_char : Char = '1'
  let variation_char = "â¤ï¸"

  // éªŒè¯å­—ç¬¦ä¸²é•¿åº¦
  assert_eq(emoji_one.length(), 2)

  // éªŒè¯å­—ç¬¦å†…å®¹
  assert_eq(emoji_one.get_char(0), Some('1'))
  assert_eq(emoji_one.get_char(1), Some('\u{fe0f}'))

  // ç›´æ¥æ¯”è¾ƒå­—ç¬¦
  assert_eq(emoji_one_char == '1', true)
  assert_eq(variation_char.get_char(1).unwrap() == '\u{fe0f}', true)

  // éªŒè¯å­—ç¬¦ç ç‚¹å€¼
  assert_eq(emoji_one_char.to_int(), 49) // '1' çš„Unicodeç ç‚¹
  // assert_eq(variation_char.to_int(), 65039) // U+FE0F çš„ç ç‚¹
}

///|
/// æµ‹è¯•å¸¸è§çš„emojiç‰¹æ®Šå­—ç¬¦
///
test "common emoji special characters" {
  // é›¶å®½åº¦è¿æ¥ç¬¦ (U+200D) - ç”¨äºemojiç»„åˆ
  let zero_width_joiner : Char = '\u{200d}'

  // è¡¨æƒ…ç¬¦å·ä¿®é¥°ç¬¦ (U+1F3FB - U+1F3FF) - è‚¤è‰²ä¿®é¥°ç¬¦
  let light_skin_tone : Char = '\u{1f3fb}'
  let medium_light_skin_tone : Char = '\u{1f3fc}'
  let medium_skin_tone : Char = '\u{1f3fd}'
  let medium_dark_skin_tone : Char = '\u{1f3fe}'
  let dark_skin_tone : Char = '\u{1f3ff}'

  // éªŒè¯è¿™äº›ç‰¹æ®Šå­—ç¬¦
  assert_eq(zero_width_joiner == '\u{200d}', true)
  assert_eq(light_skin_tone == '\u{1f3fb}', true)
  assert_eq(medium_light_skin_tone == '\u{1f3fc}', true)
  assert_eq(medium_skin_tone == '\u{1f3fd}', true)
  assert_eq(medium_dark_skin_tone == '\u{1f3fe}', true)
  assert_eq(dark_skin_tone == '\u{1f3ff}', true)

  // éªŒè¯ç ç‚¹å€¼
  assert_eq(zero_width_joiner.to_int(), 8205) // U+200D
  assert_eq(light_skin_tone.to_int(), 127995) // U+1F3FB
  assert_eq(medium_light_skin_tone.to_int(), 127996) // U+1F3FC
  assert_eq(medium_skin_tone.to_int(), 127997) // U+1F3FD
  assert_eq(medium_dark_skin_tone.to_int(), 127998) // U+1F3FE
  assert_eq(dark_skin_tone.to_int(), 127999) // U+1F3FF
}

///|
/// æµ‹è¯•emojiç»„åˆåºåˆ—
///
test "emoji combination sequences" {
  // å®¶åº­emoji: ç”·äºº + é›¶å®½åº¦è¿æ¥ç¬¦ + å¥³äºº + é›¶å®½åº¦è¿æ¥ç¬¦ + å¥³å­©
  let family : String = "ğŸ‘¨\u{200d}ğŸ‘©\u{200d}ğŸ‘§"

  // å¸¦è‚¤è‰²çš„emoji: ä¸¾æ‰‹ + è‚¤è‰²ä¿®é¥°ç¬¦
  let raised_hand_with_skin_tone : String = "âœ‹\u{1f3fd}"

  // éªŒè¯å­—ç¬¦ä¸²é•¿åº¦
  assert_eq(family.length(), 5) // æ¯ä¸ªemojiå 2ä¸ªä½ç½®ï¼Œé›¶å®½åº¦è¿æ¥ç¬¦å 1ä¸ª
  assert_eq(raised_hand_with_skin_tone.length(), 3) // emoji + ä¿®é¥°ç¬¦

  // éªŒè¯å­—ç¬¦å†…å®¹
  assert_eq(family.get_char(0), Some('ğŸ‘¨'))
  assert_eq(family.get_char(1), Some('\u{200d}'))
  assert_eq(family.get_char(2), Some('ğŸ‘©'))
  assert_eq(family.get_char(3), Some('\u{200d}'))
  assert_eq(family.get_char(4), Some('ğŸ‘§'))
  assert_eq(raised_hand_with_skin_tone.get_char(0), Some('âœ‹'))
  assert_eq(raised_hand_with_skin_tone.get_char(1), Some('\u{1f3fd}'))
}

///|
/// æµ‹è¯•å˜ä½“é€‰æ‹©ç¬¦çš„å®é™…åº”ç”¨
///
test "variation selector practical examples" {
  // ä½¿ç”¨å˜ä½“é€‰æ‹©ç¬¦å¼ºåˆ¶æ˜¾ç¤ºä¸ºemoji
  let keycap_number : String = "#\u{fe0f}" // emojié”®å¸½#
  let asterisk_emoji : String = "*\u{fe0f}" // emojié”®å¸½*

  // ä¸ä½¿ç”¨å˜ä½“é€‰æ‹©ç¬¦çš„æ™®é€šå­—ç¬¦
  let regular_hash : String = "#"
  let regular_asterisk : String = "*"

  // éªŒè¯é•¿åº¦å·®å¼‚
  assert_eq(keycap_number.length(), 2)
  assert_eq(regular_hash.length(), 1)
  assert_eq(asterisk_emoji.length(), 2)
  assert_eq(regular_asterisk.length(), 1)

  // éªŒè¯å­—ç¬¦å†…å®¹
  assert_eq(keycap_number.get_char(0), Some('#'))
  assert_eq(keycap_number.get_char(1), Some('\u{fe0f}'))
  assert_eq(regular_hash.get_char(0), Some('#'))

  // ç›´æ¥æ¯”è¾ƒå­—ç¬¦
  let hash_char : Char = '#'
  let variation_char : Char = '\u{fe0f}'
  assert_eq(hash_char == '#', true)
  assert_eq(variation_char == '\u{fe0f}', true)
  assert_eq(hash_char == variation_char, false)
}
